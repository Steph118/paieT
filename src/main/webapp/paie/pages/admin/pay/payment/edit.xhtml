<ui:composition
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="jakarta.faces.core"
    xmlns:ui="jakarta.faces.facelets"
    template="/paie/templates/layout-edit.xhtml"
    xmlns:p="primefaces"
    >    
    <ui:define name="metadata">
        <f:metadata>
            <f:viewParam name="entityId" value="#{paymentBean.entityId}"/>
            <f:viewAction action="#{paymentBean.initEntity()}"/>
        </f:metadata>
    </ui:define>

    <ui:param name="crudBean" value="#{paymentBean}"/>

    <ui:param name="fieldsTitle" value="#{msg['payment.list.title']}"/>

    <ui:define name="list-title">
        #{msg['payment.list.title']}
    </ui:define>
    <ui:define name="breadCrumb" >
        #{msg['payment.list.breadCrumb']}
    </ui:define>
    <ui:define name="fields-content">
        <div class="field sm:col-12 col-12 md:col-4 lg:col-4">
            <p:outputLabel for="eglise" value="#{msg['entites.eglise.title']}"/>
            <p:selectOneMenu id="eglise" class="w-full" filterMatchMode="startsWith"
                             filterNormalize="true" filter="true" filterPlaceholder="#{msg['search']}"
                             converter="omnifaces.SelectItemsConverter" required="true"
                             requiredMessage="#{msg['persons.edit.eglise.required']}"
                             value="#{sumPaidBean.eglise}">
                <f:selectItem noSelectionOption="true" itemLabel="#{msg['choice-label']}"/>
                <f:selectItems value="#{paymentBean.eglises}" itemValue="#{e}" var="e" itemLabel="#{e.label}"/>
                <p:ajax listener="#{sumPaidBean.loadLoansAndMembers()}" update="loan membre" process="@this"/>
            </p:selectOneMenu>
        </div>
        <div class="field sm:col-12 col-12 md:col-4 lg:col-4">
            <p:outputLabel for="dpt" value="#{msg['departement.title']}"/>
            <p:selectOneMenu id="dpt" class="w-full" filterMatchMode="startsWith"
                             filterNormalize="true" filter="true" filterPlaceholder="#{msg['search']}"
                             converter="omnifaces.SelectItemsConverter" required="true"
                             requiredMessage="#{msg['persons.edit.departement.required']}" value="#{sumPaidBean.dptment}">
                <f:selectItem noSelectionOption="true" itemLabel="#{msg['choice-label']}"/>
                <f:selectItems value="#{sumPaidBean.departments}" itemLabel="#{d.label}" var="d" itemValue="#{d}"/>
                <p:ajax update="membre" listener="#{paymentBean.loadMembers()}" process="@this"/>
            </p:selectOneMenu>
        </div>

        <div class="field sm:col-12 col-12 md:col-4 lg:col-4">
            <p:outputLabel for="membre" value="#{msg['member']}"/>
            <p:selectOneMenu id="membre" class="w-full" filterMatchMode="startsWith"
                             filterNormalize="true" filter="true" filterPlaceholder="#{msg['search']}"
                             converter="omnifaces.SelectItemsConverter" required="true"
                             requiredMessage="#{msg['member.required']}" value="#{sumPaidBean.member}">
                <f:selectItem noSelectionOption="true" itemLabel="#{msg['choice-label']}"/>
                <f:selectItems value="#{sumPaidBean.membres}" itemLabel="#{m.fullPersonFromMember()}" var="m" itemValue="#{em}"/>
            </p:selectOneMenu>
        </div>

        <div class="field sm:col-12 col-12 md:col-4 lg:col-4">
            <p:outputLabel for="loan" value="#{msg['loan.title']}"/>
            <p:selectOneMenu id="loan" class="w-full" filterMatchMode="startsWith" filterNormalize="true"
                             filter="true" filterPlaceholder="#{msg['search']}" required="true"
                             requiredMessage="#{msg['persons.edit.member.loan']}"
                             converter="omnifaces.SelectItemsConverter" value="#{sumPaidBean.loan}">
                <f:selectItem noSelectionOption="true" itemLabel="#{msg['choice-label']}"/>
                <f:selectItems value="#{sumPaidBean.loans}" itemLabel="#{l.label}" var="l" itemValue="#{l}"/>
            </p:selectOneMenu>
        </div>

        <div class="field sm:col-12 col-12 md:col-4 lg:col-4">
            <p:outputLabel for="year" value="#{msg['references.annee.title']}"/>
            <p:selectOneMenu id="year" class="w-full" filterMatchMode="startsWith" filterNormalize="true"
                             filter="true" filterPlaceholder="#{msg['search']}" required="true"
                             requiredMessage="#{msg['persons.edit.member.loan']}"
                             converter="omnifaces.SelectItemsConverter" value="#{sumPaidBean.year}">
                <f:selectItem noSelectionOption="true" itemLabel="#{msg['choice-label']}"/>
                <f:selectItems value="#{sumPaidBean.years}" itemLabel="#{y.value}" var="y" itemValue="#{y}"/>
            </p:selectOneMenu>
        </div>

        <div class="field sm:col-12 col-12 md:col-4 lg:col-4">
            <p:outputLabel for="sumPromised" value="#{msg['promised.list.single.title']}"/>
            <p:inputText id="sumPromised" class="w-full bg-blue-50 bold text-1xl" requiredMessage="#{msg['promised.list.single.title']}"
                         disabled="true" value="#{sumPaidBean.sumPromised}"/>
        </div>


        <p:fieldset class="w-full mt-3" legend="Somme a payer" rendered="true">
            <div class="form-grid grid ui-fluid">
                <div class="field sm:col-12 col-12 md:col-6 lg:col-6">
                    <p:outputLabel for="month" value="#{msg['month.title']}"/>
                    <p:selectOneMenu id="month" class="w-full" filterMatchMode="startsWith" filterNormalize="true"
                                     filter="true" filterPlaceholder="#{msg['search']}" required="true"
                                     requiredMessage="#{msg['month.required']}"
                                     converter="omnifaces.SelectItemsConverter">
                        <f:selectItem noSelectionOption="true" itemLabel="#{msg['choice-label']}"/>
                        <f:selectItems />
                    </p:selectOneMenu>
                </div>
                <div class="field sm:col-12 col-12 md:col-6 lg:col-6">
                    <p:outputLabel for="month" value="#{msg['payment.edit.amount']}"/>
                    <p:inputNumber id="montantVersement" class="w-full" required="true" requiredMessage="#{msg['payment.edit.amount.required']}" 
                                   value="" disabled="true"/>
                </div>
            </div>
        </p:fieldset>
    </ui:define>

</ui:composition>

